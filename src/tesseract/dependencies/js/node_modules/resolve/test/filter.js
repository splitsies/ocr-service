var path=require("path"),test=require("tape"),resolve=require("../");test("filter",(function(t){t.plan(4);var packageFilterArgs,dir=path.join(__dirname,"resolver");resolve("./baz",{basedir:dir,packageFilter:function(pkg,pkgfile){return pkg.main="doom",packageFilterArgs=[pkg,pkgfile],pkg}},(function(err,res,pkg){err&&t.fail(err),t.equal(res,path.join(dir,"baz/doom.js"),'changing the package "main" works');var packageData=packageFilterArgs[0];t.equal(pkg,packageData,'first packageFilter argument is "pkg"'),t.equal(packageData.main,"doom",'package "main" was altered');var packageFile=packageFilterArgs[1];t.equal(packageFile,path.join(dir,"baz/package.json"),'second packageFilter argument is "pkgfile"'),t.end()}))}));