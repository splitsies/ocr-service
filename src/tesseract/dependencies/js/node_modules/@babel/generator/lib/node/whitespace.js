Object.defineProperty(exports,"__esModule",{value:!0}),exports.nodes=void 0;var _t=require("@babel/types");const{FLIPPED_ALIAS_KEYS:FLIPPED_ALIAS_KEYS,isArrayExpression:isArrayExpression,isAssignmentExpression:isAssignmentExpression,isBinary:isBinary,isBlockStatement:isBlockStatement,isCallExpression:isCallExpression,isFunction:isFunction,isIdentifier:isIdentifier,isLiteral:isLiteral,isMemberExpression:isMemberExpression,isObjectExpression:isObjectExpression,isOptionalCallExpression:isOptionalCallExpression,isOptionalMemberExpression:isOptionalMemberExpression,isStringLiteral:isStringLiteral}=_t;function crawlInternal(node,state){return node?(isMemberExpression(node)||isOptionalMemberExpression(node)?(crawlInternal(node.object,state),node.computed&&crawlInternal(node.property,state)):isBinary(node)||isAssignmentExpression(node)?(crawlInternal(node.left,state),crawlInternal(node.right,state)):isCallExpression(node)||isOptionalCallExpression(node)?(state.hasCall=!0,crawlInternal(node.callee,state)):isFunction(node)?state.hasFunction=!0:isIdentifier(node)&&(state.hasHelper=state.hasHelper||node.callee&&isHelper(node.callee)),state):state}function crawl(node){return crawlInternal(node,{hasCall:!1,hasFunction:!1,hasHelper:!1})}function isHelper(node){return!!node&&(isMemberExpression(node)?isHelper(node.object)||isHelper(node.property):isIdentifier(node)?"require"===node.name||95===node.name.charCodeAt(0):isCallExpression(node)?isHelper(node.callee):!(!isBinary(node)&&!isAssignmentExpression(node))&&(isIdentifier(node.left)&&isHelper(node.left)||isHelper(node.right)))}function isType(node){return isLiteral(node)||isObjectExpression(node)||isArrayExpression(node)||isIdentifier(node)||isMemberExpression(node)}const nodes={AssignmentExpression(node){const state=crawl(node.right);if(state.hasCall&&state.hasHelper||state.hasFunction)return state.hasFunction?3:2},SwitchCase:(node,parent)=>(node.consequent.length||parent.cases[0]===node?1:0)|(node.consequent.length||parent.cases[parent.cases.length-1]!==node?0:2),LogicalExpression(node){if(isFunction(node.left)||isFunction(node.right))return 2},Literal(node){if(isStringLiteral(node)&&"use strict"===node.value)return 2},CallExpression(node){if(isFunction(node.callee)||isHelper(node))return 3},OptionalCallExpression(node){if(isFunction(node.callee))return 3},VariableDeclaration(node){for(let i=0;i<node.declarations.length;i++){const declar=node.declarations[i];let enabled=isHelper(declar.id)&&!isType(declar.init);if(!enabled&&declar.init){const state=crawl(declar.init);enabled=isHelper(declar.init)&&state.hasCall||state.hasFunction}if(enabled)return 3}},IfStatement(node){if(isBlockStatement(node.consequent))return 3}};exports.nodes=nodes,nodes.ObjectProperty=nodes.ObjectTypeProperty=nodes.ObjectMethod=function(node,parent){if(parent.properties[0]===node)return 1},nodes.ObjectTypeCallProperty=function(node,parent){var _parent$properties;if(parent.callProperties[0]===node&&(null==(_parent$properties=parent.properties)||!_parent$properties.length))return 1},nodes.ObjectTypeIndexer=function(node,parent){var _parent$properties2,_parent$callPropertie;if(!(parent.indexers[0]!==node||null!=(_parent$properties2=parent.properties)&&_parent$properties2.length||null!=(_parent$callPropertie=parent.callProperties)&&_parent$callPropertie.length))return 1},nodes.ObjectTypeInternalSlot=function(node,parent){var _parent$properties3,_parent$callPropertie2,_parent$indexers;if(!(parent.internalSlots[0]!==node||null!=(_parent$properties3=parent.properties)&&_parent$properties3.length||null!=(_parent$callPropertie2=parent.callProperties)&&_parent$callPropertie2.length||null!=(_parent$indexers=parent.indexers)&&_parent$indexers.length))return 1},[["Function",!0],["Class",!0],["Loop",!0],["LabeledStatement",!0],["SwitchStatement",!0],["TryStatement",!0]].forEach((function([type,amounts]){[type].concat(FLIPPED_ALIAS_KEYS[type]||[]).forEach((function(type){const ret=amounts?3:0;nodes[type]=()=>ret}))}));