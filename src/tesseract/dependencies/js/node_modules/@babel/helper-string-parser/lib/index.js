Object.defineProperty(exports,"__esModule",{value:!0}),exports.readCodePoint=readCodePoint,exports.readInt=readInt,exports.readStringContents=readStringContents;var _isDigit=function(code){return code>=48&&code<=57};const forbiddenNumericSeparatorSiblings={decBinOct:new Set([46,66,69,79,95,98,101,111]),hex:new Set([46,88,95,120])},isAllowedNumericSeparatorSibling={bin:ch=>48===ch||49===ch,oct:ch=>ch>=48&&ch<=55,dec:ch=>ch>=48&&ch<=57,hex:ch=>ch>=48&&ch<=57||ch>=65&&ch<=70||ch>=97&&ch<=102};function readStringContents(type,input,pos,lineStart,curLine,errors){const initialPos=pos,initialLineStart=lineStart,initialCurLine=curLine;let out="",firstInvalidLoc=null,chunkStart=pos;const{length:length}=input;for(;;){if(pos>=length){errors.unterminated(initialPos,initialLineStart,initialCurLine),out+=input.slice(chunkStart,pos);break}const ch=input.charCodeAt(pos);if(isStringEnd(type,ch,input,pos)){out+=input.slice(chunkStart,pos);break}if(92===ch){out+=input.slice(chunkStart,pos);const res=readEscapedChar(input,pos,lineStart,curLine,"template"===type,errors);null!==res.ch||firstInvalidLoc?out+=res.ch:firstInvalidLoc={pos:pos,lineStart:lineStart,curLine:curLine},({pos:pos,lineStart:lineStart,curLine:curLine}=res),chunkStart=pos}else 8232===ch||8233===ch?(++curLine,lineStart=++pos):10===ch||13===ch?"template"===type?(out+=input.slice(chunkStart,pos)+"\n",++pos,13===ch&&10===input.charCodeAt(pos)&&++pos,++curLine,chunkStart=lineStart=pos):errors.unterminated(initialPos,initialLineStart,initialCurLine):++pos}return{pos:pos,str:out,firstInvalidLoc:firstInvalidLoc,lineStart:lineStart,curLine:curLine,containsInvalid:!!firstInvalidLoc}}function isStringEnd(type,ch,input,pos){return"template"===type?96===ch||36===ch&&123===input.charCodeAt(pos+1):ch===("double"===type?34:39)}function readEscapedChar(input,pos,lineStart,curLine,inTemplate,errors){const throwOnInvalid=!inTemplate;pos++;const res=ch=>({pos:pos,ch:ch,lineStart:lineStart,curLine:curLine}),ch=input.charCodeAt(pos++);switch(ch){case 110:return res("\n");case 114:return res("\r");case 120:{let code;return({code:code,pos:pos}=readHexChar(input,pos,lineStart,curLine,2,!1,throwOnInvalid,errors)),res(null===code?null:String.fromCharCode(code))}case 117:{let code;return({code:code,pos:pos}=readCodePoint(input,pos,lineStart,curLine,throwOnInvalid,errors)),res(null===code?null:String.fromCodePoint(code))}case 116:return res("\t");case 98:return res("\b");case 118:return res("\v");case 102:return res("\f");case 13:10===input.charCodeAt(pos)&&++pos;case 10:lineStart=pos,++curLine;case 8232:case 8233:return res("");case 56:case 57:if(inTemplate)return res(null);errors.strictNumericEscape(pos-1,lineStart,curLine);default:if(ch>=48&&ch<=55){const startPos=pos-1;let octalStr=input.slice(startPos,pos+2).match(/^[0-7]+/)[0],octal=parseInt(octalStr,8);octal>255&&(octalStr=octalStr.slice(0,-1),octal=parseInt(octalStr,8)),pos+=octalStr.length-1;const next=input.charCodeAt(pos);if("0"!==octalStr||56===next||57===next){if(inTemplate)return res(null);errors.strictNumericEscape(startPos,lineStart,curLine)}return res(String.fromCharCode(octal))}return res(String.fromCharCode(ch))}}function readHexChar(input,pos,lineStart,curLine,len,forceLen,throwOnInvalid,errors){const initialPos=pos;let n;return({n:n,pos:pos}=readInt(input,pos,lineStart,curLine,16,len,forceLen,!1,errors,!throwOnInvalid)),null===n&&(throwOnInvalid?errors.invalidEscapeSequence(initialPos,lineStart,curLine):pos=initialPos-1),{code:n,pos:pos}}function readInt(input,pos,lineStart,curLine,radix,len,forceLen,allowNumSeparator,errors,bailOnError){const start=pos,forbiddenSiblings=16===radix?forbiddenNumericSeparatorSiblings.hex:forbiddenNumericSeparatorSiblings.decBinOct,isAllowedSibling=16===radix?isAllowedNumericSeparatorSibling.hex:10===radix?isAllowedNumericSeparatorSibling.dec:8===radix?isAllowedNumericSeparatorSibling.oct:isAllowedNumericSeparatorSibling.bin;let invalid=!1,total=0;for(let i=0,e=null==len?1/0:len;i<e;++i){const code=input.charCodeAt(pos);let val;if(95!==code||"bail"===allowNumSeparator){if(val=code>=97?code-97+10:code>=65?code-65+10:_isDigit(code)?code-48:1/0,val>=radix){if(val<=9&&bailOnError)return{n:null,pos:pos};if(val<=9&&errors.invalidDigit(pos,lineStart,curLine,radix))val=0;else{if(!forceLen)break;val=0,invalid=!0}}++pos,total=total*radix+val}else{const prev=input.charCodeAt(pos-1),next=input.charCodeAt(pos+1);if(allowNumSeparator){if(Number.isNaN(next)||!isAllowedSibling(next)||forbiddenSiblings.has(prev)||forbiddenSiblings.has(next)){if(bailOnError)return{n:null,pos:pos};errors.unexpectedNumericSeparator(pos,lineStart,curLine)}}else{if(bailOnError)return{n:null,pos:pos};errors.numericSeparatorInEscapeSequence(pos,lineStart,curLine)}++pos}}return pos===start||null!=len&&pos-start!==len||invalid?{n:null,pos:pos}:{n:total,pos:pos}}function readCodePoint(input,pos,lineStart,curLine,throwOnInvalid,errors){let code;if(123===input.charCodeAt(pos)){if(++pos,({code:code,pos:pos}=readHexChar(input,pos,lineStart,curLine,input.indexOf("}",pos)-pos,!0,throwOnInvalid,errors)),++pos,null!==code&&code>1114111){if(!throwOnInvalid)return{code:null,pos:pos};errors.invalidCodePoint(pos,lineStart,curLine)}}else({code:code,pos:pos}=readHexChar(input,pos,lineStart,curLine,4,!1,throwOnInvalid,errors));return{code:code,pos:pos}}